<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DAW - E06</title>

    <script>
        function csvToTable(){
            let body = document.body;

            let csv = document.getElementById('csvFiletxt').value;
            console.log(csv);

            let csvLines = csv.split(/\r?\n/);
            console.log(csvLines);

            //criando tabela e atributos
            let table = document.createElement('table');
            let tableAttr = document.createAttribute('border');
            let tableHead = document.createElement('thead');
            let tableBody = document.createElement('tbody');

            //adicionando cabeçalho e estilo
            tableAttr.value = 2;
            table.setAttributeNode(tableAttr);
            table.appendChild(tableHead);
            table.appendChild(tableBody);

            //adicionando tabela toda
            body.appendChild(table);

            //adicionando elementos na tabela
            for(i = 0; i < csvLines.length; i++){
                let row = document.createElement('tr');
                let csvCollumns = csvLines[i].split(",");
                for(j = 0; j < csvCollumns.length; j++){
                    let heading = document.createElement('th');
                    heading.innerHTML = csvCollumns[j];
                    row.appendChild(heading);
                }
                //verificação simples de se deve ser colocado no head ou no body
                if(!i){
                    tableHead.appendChild(row);
                }
                else{
                    tableBody.appendChild(row);
                }
            }
        }
    </script>

</head>
<body>
    <!--<form>
        <label for="csvfile">csv file</label><br>
        <input type="text" id="csvFile" name="csvFile" class="csvFile"><br>
    </form>-->

    <label for="csvFiletxt">insert csv file</label>

    <textarea id="csvFiletxt" name="csvFiletxt" rows="4" cols="50"></textarea> 

    <br>

    <input type= "submit" value= "runjs" onclick="csvToTable()"/>
</body>
<!--<script src="main.js"></script>-->
</html>